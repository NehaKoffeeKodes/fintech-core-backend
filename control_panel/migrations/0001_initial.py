# Generated by Django 5.2.8 on 2025-12-11 12:25

import django.core.validators
import django.db.models.deletion
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Admin',
            fields=[
                ('entity_id', models.AutoField(primary_key=True, serialize=False)),
                ('entity_name', models.CharField(max_length=150, unique=True)),
                ('mobile', models.CharField(max_length=10, unique=True)),
                ('email', models.EmailField(max_length=254, unique=True)),
                ('avatar', models.ImageField(blank=True, null=True, upload_to='entities/avatar/')),
                ('pan', models.CharField(blank=True, max_length=10, null=True, unique=True)),
                ('aadhaar', models.CharField(blank=True, max_length=12, null=True, unique=True)),
                ('is_pan_verified', models.BooleanField(default=False)),
                ('is_gst_verified', models.BooleanField(default=False)),
                ('company_title', models.CharField(blank=True, max_length=255, null=True)),
                ('gst_number', models.CharField(blank=True, max_length=15, null=True, unique=True)),
                ('gst_regime', models.CharField(choices=[('COMPOSITION', 'Composition'), ('REGULAR', 'Regular'), ('UNREGISTERED', 'Unregistered'), ('SEZ', 'SEZ'), ('EXPORT', 'Exports'), ('ECOMMERCE', 'E-Commerce')], default='COMPOSITION', max_length=20)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected')], default='PENDING', max_length=20)),
                ('rejection_reason', models.TextField(blank=True, null=True)),
                ('documents_uploaded', models.JSONField(blank=True, default=list)),
                ('pin_code', models.CharField(blank=True, max_length=6, null=True)),
                ('enabled_services', models.JSONField(blank=True, default=list)),
                ('agreement_pdf', models.FileField(blank=True, null=True, upload_to='agreements/')),
                ('is_active', models.BooleanField(default=True)),
                ('is_soft_deleted', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'db_table': 'platform_business_entities',
            },
        ),
        migrations.CreateModel(
            name='Location',
            fields=[
                ('locality_id', models.AutoField(primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=150)),
                ('active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('created_by', models.PositiveIntegerField(blank=True, null=True)),
                ('updated_at', models.DateTimeField(blank=True, null=True)),
                ('updated_by', models.PositiveIntegerField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Locality',
                'verbose_name_plural': ' Locations',
                'db_table': 'master_locations',
            },
        ),
        migrations.CreateModel(
            name='Region',
            fields=[
                ('region_id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(db_index=True, max_length=120, unique=True)),
                ('short_code', models.CharField(blank=True, max_length=10, null=True)),
                ('status', models.BooleanField(default=True)),
                ('added_on', models.DateTimeField(auto_now_add=True)),
                ('added_by', models.PositiveIntegerField(blank=True, null=True)),
                ('modified_on', models.DateTimeField(blank=True, null=True)),
                ('modified_by', models.PositiveIntegerField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Region',
                'verbose_name_plural': 'Regions',
                'db_table': 'master_regions',
            },
        ),
        migrations.CreateModel(
            name='AdminContract',
            fields=[
                ('contract_id', models.AutoField(primary_key=True, serialize=False)),
                ('base_amount', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('gst_component', models.DecimalField(blank=True, decimal_places=2, editable=False, max_digits=20, null=True)),
                ('signed_document', models.FileField(blank=True, null=True, upload_to='contracts/signed/')),
                ('contract_status', models.CharField(choices=[('DRAFT', 'Draft'), ('UNDER_REVIEW', 'Under Review'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected'), ('TERMINATED', 'Terminated')], default='DRAFT', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('admin', models.ForeignKey(null=True, on_delete=django.db.models.deletion.CASCADE, related_name='contracts', to='control_panel.admin')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_contracts', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'admin Contract',
                'verbose_name_plural': 'admin Contracts',
                'db_table': 'admin_contracts',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='DocumentTemplate',
            fields=[
                ('template_id', models.AutoField(primary_key=True, serialize=False)),
                ('display_name', models.CharField(help_text='Name shown to user', max_length=100)),
                ('internal_code', models.CharField(db_index=True, max_length=100, unique=True)),
                ('slug_key', models.SlugField(max_length=120, unique=True)),
                ('mandatory', models.BooleanField(default=False)),
                ('active', models.BooleanField(default=True)),
                ('soft_deleted', models.BooleanField(default=False)),
                ('added_on', models.DateTimeField(auto_now_add=True)),
                ('modified_on', models.DateTimeField(blank=True, null=True)),
                ('added_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_templates', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Document Template',
                'db_table': 'master_document_templates',
                'ordering': ['-template_id'],
            },
        ),
        migrations.CreateModel(
            name='GSTCode',
            fields=[
                ('gst_id', models.AutoField(primary_key=True, serialize=False)),
                ('gst_code', models.CharField(max_length=20, unique=True)),
                ('cgst', models.DecimalField(decimal_places=2, max_digits=5)),
                ('sgst', models.DecimalField(decimal_places=2, max_digits=5)),
                ('igst', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('notes', models.TextField(blank=True)),
                ('is_hidden', models.BooleanField(default=False)),
                ('is_removed', models.BooleanField(default=False)),
                ('added_on', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(blank=True, null=True)),
                ('added_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='gst_entries_added', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='gst_entries_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'tax_gst_codes',
                'ordering': ['-gst_id'],
            },
        ),
        migrations.CreateModel(
            name='AdditionalFee',
            fields=[
                ('fee_id', models.AutoField(primary_key=True, serialize=False)),
                ('title', models.CharField(blank=True, max_length=150, null=True)),
                ('category', models.CharField(blank=True, max_length=60, null=True)),
                ('amount', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('is_removed', models.BooleanField(default=False)),
                ('added_on', models.DateTimeField(auto_now_add=True)),
                ('added_by', models.PositiveIntegerField(blank=True, null=True)),
                ('tax_code', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='control_panel.gstcode')),
            ],
            options={
                'verbose_name': 'Extra Charge',
                'verbose_name_plural': 'Extra Charges',
                'db_table': 'master_extra_fees',
                'ordering': ['-fee_id'],
            },
        ),
        migrations.AddField(
            model_name='admin',
            name='registered_city',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='control_panel.location'),
        ),
        migrations.CreateModel(
            name='PortalUser',
            fields=[
                ('member_id', models.AutoField(primary_key=True, serialize=False)),
                ('full_name', models.CharField(db_index=True, max_length=200)),
                ('email_address', models.EmailField(db_index=True, max_length=254, unique=True)),
                ('mobile_number', models.CharField(max_length=10, validators=[django.core.validators.RegexValidator('^\\d{10}$', 'Enter a valid 10-digit mobile number')])),
                ('access_pin', models.CharField(blank=True, max_length=128, null=True)),
                ('member_type', models.CharField(choices=[('SUPER_ADMIN', 'Super Admin'), ('DISTRIBUTOR', 'Distributor'), ('RETAILER', 'Retailer')], max_length=30)),
                ('otp_token', models.CharField(blank=True, max_length=100, null=True)),
                ('otp_expiry', models.DateTimeField(blank=True, null=True)),
                ('email_confirmed', models.BooleanField(default=False)),
                ('virtual_account_active', models.BooleanField(default=False)),
                ('kyc_completed', models.BooleanField(default=False)),
                ('aeps_service_status', models.CharField(default='NOT_STARTED', max_length=50)),
                ('aeps_merchant_code', models.CharField(blank=True, max_length=80, null=True)),
                ('rejection_note', models.TextField(blank=True, null=True)),
                ('service_config', models.JSONField(blank=True, default=dict, null=True)),
                ('allowed_domains', models.JSONField(blank=True, default=list, null=True)),
                ('active_modules', models.JSONField(blank=True, default=list, null=True)),
                ('pinned_features', models.JSONField(blank=True, default=dict, null=True)),
                ('extra_info', models.JSONField(blank=True, default=dict, null=True)),
                ('account_status', models.CharField(choices=[('PENDING_REVIEW', 'Pending Review'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected'), ('KYC_IN_PROGRESS', 'KYC In Progress')], default='PENDING_REVIEW', max_length=30)),
                ('two_factor_secret', models.CharField(blank=True, max_length=80, null=True)),
                ('registered_at', models.DateTimeField(auto_now_add=True)),
                ('last_updated', models.DateTimeField(auto_now=True)),
                ('is_suspended', models.BooleanField(default=False)),
                ('is_removed', models.BooleanField(default=False)),
                ('registered_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='members_created_by_me', to='control_panel.portaluser')),
            ],
            options={
                'verbose_name': 'System Member',
                'verbose_name_plural': 'System Members',
                'db_table': 'core_system_members',
                'ordering': ['-registered_at'],
            },
        ),
        migrations.CreateModel(
            name='PaymentGatewayBank',
            fields=[
                ('bank_id', models.AutoField(primary_key=True, serialize=False)),
                ('supported_services', models.JSONField(default=list, help_text="Example: ['UPI', 'IMPS', 'NEFT', 'Cash Deposit']")),
                ('bank_full_name', models.CharField(blank=True, max_length=200, null=True)),
                ('ifsc', models.CharField(blank=True, max_length=11, null=True, validators=[django.core.validators.RegexValidator('^[A-Z]{4}0[A-Z0-9]{6}$', 'Enter valid IFSC code')])),
                ('branch', models.CharField(blank=True, max_length=150, null=True)),
                ('account_holder_name', models.CharField(blank=True, max_length=200, null=True)),
                ('account_no', models.CharField(blank=True, max_length=30, null=True)),
                ('account_category', models.CharField(blank=True, max_length=50, null=True)),
                ('upi_imps_charges', models.JSONField(blank=True, default=dict, null=True)),
                ('cash_deposit_machine_charges', models.JSONField(blank=True, default=dict, null=True)),
                ('over_the_counter_charges', models.JSONField(blank=True, default=dict, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('is_archived', models.BooleanField(default=False)),
                ('added_on', models.DateTimeField(auto_now_add=True)),
                ('modified_on', models.DateTimeField(auto_now=True)),
                ('added_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='bank_accounts_added', to='control_panel.portaluser')),
                ('modified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='bank_accounts_modified', to='control_panel.portaluser')),
            ],
            options={
                'verbose_name': 'Payment Gateway Bank',
                'verbose_name_plural': 'Payment Gateway Banks',
                'db_table': 'gateway_banks_config',
                'ordering': ['-added_on'],
            },
        ),
        migrations.CreateModel(
            name='MemberActionLog',
            fields=[
                ('log_id', models.AutoField(primary_key=True, serialize=False)),
                ('record_id', models.BigIntegerField(blank=True, db_index=True, null=True)),
                ('module_name', models.CharField(blank=True, db_index=True, max_length=100, null=True)),
                ('action_type', models.CharField(db_index=True, max_length=80)),
                ('action_details', models.TextField(blank=True, null=True)),
                ('performed_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('request_payload', models.JSONField(blank=True, null=True)),
                ('response_payload', models.JSONField(blank=True, null=True)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.CharField(blank=True, max_length=255, null=True)),
                ('performed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='action_logs', to='control_panel.portaluser')),
            ],
            options={
                'verbose_name': 'Activity Log',
                'verbose_name_plural': 'Activity Logs',
                'db_table': 'core_activity_logs',
                'ordering': ['-performed_at'],
            },
        ),
        migrations.CreateModel(
            name='GlTrn',
            fields=[
                ('entry_id', models.AutoField(primary_key=True, serialize=False)),
                ('linked_service_id', models.BigIntegerField(blank=True, null=True)),
                ('transaction_type', models.CharField(blank=True, max_length=100)),
                ('amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('tds_percent', models.DecimalField(decimal_places=4, default=Decimal('0.0000'), max_digits=8)),
                ('gst_percent', models.DecimalField(decimal_places=4, default=Decimal('0.0000'), max_digits=8)),
                ('tds_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('gst_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('source_table', models.CharField(blank=True, max_length=100)),
                ('wallet_type', models.CharField(blank=True, max_length=30)),
                ('final_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('entry_nature', models.CharField(choices=[('CR', 'Credit'), ('DR', 'Debit')], max_length=6)),
                ('transaction_time', models.DateTimeField(blank=True, null=True)),
                ('recorded_at', models.DateTimeField(auto_now_add=True)),
                ('member', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='ledger_entries', to='control_panel.portaluser')),
            ],
            options={
                'db_table': 'core_ledger_entries',
                'ordering': ['-recorded_at'],
            },
        ),
        migrations.CreateModel(
            name='DepositBankAccount',
            fields=[
                ('account_id', models.AutoField(primary_key=True, serialize=False)),
                ('enabled_channels', models.JSONField(default=list, help_text="List of allowed deposit channels e.g. ['UPI', 'NEFT', 'Cash Deposit']")),
                ('bank_title', models.CharField(blank=True, max_length=180, null=True)),
                ('ifsc_code', models.CharField(blank=True, max_length=11, null=True, unique=True, validators=[django.core.validators.RegexValidator('^[A-Z]{4}0[A-Z0-9]{6}$')])),
                ('branch_location', models.CharField(blank=True, max_length=200, null=True)),
                ('holder_name', models.CharField(blank=True, max_length=200, null=True)),
                ('account_number', models.CharField(blank=True, max_length=30, null=True, unique=True)),
                ('account_kind', models.CharField(blank=True, max_length=50, null=True)),
                ('digital_transfer_fees', models.JSONField(blank=True, default=dict, null=True)),
                ('cdm_deposit_fees', models.JSONField(blank=True, default=dict, null=True)),
                ('branch_counter_fees', models.JSONField(blank=True, default=dict, null=True)),
                ('is_enabled', models.BooleanField(default=True)),
                ('is_archived', models.BooleanField(default=False)),
                ('added_at', models.DateTimeField(auto_now_add=True)),
                ('modified_at', models.DateTimeField(auto_now=True)),
                ('added_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='deposit_banks_created', to='control_panel.portaluser')),
                ('modified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='deposit_banks_updated', to='control_panel.portaluser')),
            ],
            options={
                'verbose_name': 'Deposit Bank Account',
                'db_table': 'config_deposit_banks',
                'ordering': ['-added_at'],
            },
        ),
        migrations.AddField(
            model_name='admin',
            name='created_by',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='entities_created_by', to='control_panel.portaluser'),
        ),
        migrations.CreateModel(
            name='PortalUserInfo',
            fields=[
                ('profile_id', models.AutoField(primary_key=True, serialize=False)),
                ('unique_member_code', models.CharField(blank=True, max_length=12, unique=True)),
                ('aadhaar_number', models.CharField(blank=True, max_length=12, null=True, validators=[django.core.validators.RegexValidator('^\\d{12}$', 'Aadhaar must be 12 digits')])),
                ('pan_number', models.CharField(blank=True, max_length=10, null=True, unique=True, validators=[django.core.validators.RegexValidator('^[A-Z]{5}[0-9]{4}[A-Z]$', 'Invalid PAN format')])),
                ('pan_verification_data', models.JSONField(blank=True, null=True)),
                ('business_name', models.CharField(blank=True, max_length=200, null=True)),
                ('outlet_photo', models.ImageField(blank=True, null=True, upload_to='outlets/')),
                ('outlet_coordinates', models.JSONField(blank=True, null=True)),
                ('full_address', models.TextField(blank=True, null=True)),
                ('pincode', models.CharField(blank=True, max_length=6, null=True, validators=[django.core.validators.RegexValidator('^\\d{6}$')])),
                ('supporting_documents', models.JSONField(blank=True, default=list)),
                ('gstin', models.CharField(blank=True, max_length=15, null=True, unique=True)),
                ('business_category', models.CharField(blank=True, max_length=20, null=True)),
                ('secondary_mobile', models.CharField(blank=True, max_length=10, null=True)),
                ('live_location_capture', models.JSONField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('city_ref', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='control_panel.location')),
                ('created_by_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='profiles_created', to='control_panel.portaluser')),
                ('hierarchy_node', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='control_panel.portaluser')),
                ('user_account', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='profile_details', to='control_panel.portaluser')),
                ('state_ref', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='control_panel.region')),
            ],
            options={
                'verbose_name': 'Member Profile',
                'db_table': 'core_member_profiles',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='location',
            name='region',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='localities', to='control_panel.region'),
        ),
        migrations.AddField(
            model_name='admin',
            name='registered_state',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='control_panel.region'),
        ),
        migrations.CreateModel(
            name='SaAdditionalCharges',
            fields=[
                ('fee_id', models.AutoField(primary_key=True, serialize=False)),
                ('title', models.CharField(blank=True, max_length=150, null=True)),
                ('category', models.CharField(blank=True, max_length=60, null=True)),
                ('amount', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('is_removed', models.BooleanField(default=False)),
                ('added_on', models.DateTimeField(auto_now_add=True)),
                ('added_by', models.PositiveIntegerField(blank=True, null=True)),
                ('tax_code', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='control_panel.gstcode')),
            ],
            options={
                'verbose_name': 'Extra Charge',
                'verbose_name_plural': 'Extra Charges',
                'db_table': 'Sa_admin_fees',
                'ordering': ['-fee_id'],
            },
        ),
        migrations.CreateModel(
            name='SaCoreService',
            fields=[
                ('service_key', models.AutoField(primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=80, unique=True)),
                ('routing_order', models.JSONField(blank=True, null=True)),
                ('details', models.TextField(blank=True, null=True)),
                ('last_modified', models.DateTimeField(auto_now=True)),
                ('disabled', models.BooleanField(default=False)),
                ('modified_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Core Service',
                'db_table': 'core_services',
            },
        ),
        migrations.CreateModel(
            name='ServiceProvider',
            fields=[
                ('admin_id', models.AutoField(primary_key=True, serialize=False)),
                ('admin_code', models.CharField(max_length=100, unique=True)),
                ('display_label', models.CharField(max_length=200)),
                ('api_credentials', models.JSONField(blank=True, null=True)),
                ('required_params', models.JSONField(blank=True, null=True)),
                ('tds_percentage', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('tds_applicable', models.CharField(blank=True, choices=[('WITH_TDS', 'With TDS'), ('WITHOUT_TDS', 'Without TDS')], max_length=20, null=True)),
                ('wallet_type', models.CharField(blank=True, max_length=30, null=True)),
                ('supports_balance_check', models.BooleanField(default=False)),
                ('is_charge_service', models.BooleanField(default=False)),
                ('platform_charge', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('charge_type', models.CharField(blank=True, max_length=10, null=True)),
                ('last_updated', models.DateTimeField(auto_now=True)),
                ('is_inactive', models.BooleanField(default=False)),
                ('is_removed', models.BooleanField(default=False)),
                ('hsn_code', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='control_panel.gstcode')),
                ('service', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='admins', to='control_panel.sacoreservice')),
                ('updated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'service_admins',
            },
        ),
        migrations.CreateModel(
            name='ChargeRule',
            fields=[
                ('rule_id', models.AutoField(primary_key=True, serialize=False)),
                ('charge_type', models.CharField(choices=[('CREDIT', 'Credit'), ('DEBIT', 'Debit')], max_length=10)),
                ('rate_mode', models.CharField(choices=[('FLAT', 'Flat Amount'), ('PERCENT', 'Percentage')], max_length=15)),
                ('min_amount', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('max_amount', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('rate_value', models.DecimalField(blank=True, decimal_places=4, max_digits=10, null=True)),
                ('linked_identifier', models.PositiveIntegerField(blank=True, help_text='e.g., Operator ID, Biller ID', null=True)),
                ('charge_beneficiary', models.CharField(choices=[('OUR_SHARE', 'Our Share'), ('admin_SHARE', 'admin Share')], default='OUR_SHARE', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True, null=True)),
                ('is_disabled', models.BooleanField(default=False)),
                ('is_deleted', models.BooleanField(default=False)),
                ('updated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='modified_charge_rules', to=settings.AUTH_USER_MODEL)),
                ('service_provider', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='charge_rules', to='control_panel.serviceprovider')),
            ],
            options={
                'verbose_name': 'Charge Rule',
                'verbose_name_plural': 'Charge Rules',
                'db_table': 'provider_charge_rules',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AdminService',
            fields=[
                ('assignment_id', models.AutoField(primary_key=True, serialize=False)),
                ('commission_structure', models.JSONField(blank=True, default=dict, help_text='Flexible JSON for flat/percent/slab-based commissions')),
                ('commission_rate', models.DecimalField(decimal_places=4, help_text='e.g., 1.5 for 1.5%, or flat amount if structure defines', max_digits=8)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True, null=True)),
                ('is_suspended', models.BooleanField(default=False)),
                ('is_removed', models.BooleanField(default=False)),
                ('admin', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='assigned_services', to='control_panel.admin')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='service_assignments_created', to=settings.AUTH_USER_MODEL)),
                ('service', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='admin_assignments', to='control_panel.sacoreservice')),
                ('provider', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='admin_service_links', to='control_panel.serviceprovider')),
            ],
            options={
                'verbose_name': 'admin Service Assignment',
                'db_table': 'admin_service_assignments',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='WalletHistory',
            fields=[
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('reference_id', models.BigIntegerField(blank=True, null=True)),
                ('action_name', models.CharField(max_length=150)),
                ('wallet_name', models.CharField(max_length=50)),
                ('changed_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('change_type', models.CharField(choices=[('CR', 'Credit'), ('DR', 'Debit')], max_length=6)),
                ('balance_after', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('remarks', models.CharField(blank=True, max_length=500)),
                ('transaction_date', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='wallet_history', to='control_panel.portaluser')),
            ],
            options={
                'verbose_name': 'Wallet Transaction',
                'verbose_name_plural': 'Wallet Transactions',
                'db_table': 'core_wallet_history',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='FundDepositRequest',
            fields=[
                ('request_ref', models.AutoField(primary_key=True, serialize=False)),
                ('deposit_methods', models.JSONField(default=list, help_text="Which methods used: ['UPI', 'Cash Deposit']")),
                ('deposit_amount', models.DecimalField(decimal_places=2, max_digits=15)),
                ('reference_id', models.CharField(blank=True, max_length=100, null=True, unique=True)),
                ('utr_ref', models.CharField(blank=True, db_index=True, max_length=50, null=True, unique=True)),
                ('transfer_mode', models.CharField(blank=True, choices=[('UPI', 'UPI'), ('IMPS', 'IMPS'), ('NEFT', 'NEFT'), ('RTGS', 'RTGS'), ('CASH', 'Cash Deposit'), ('CDM', 'CDM Deposit')], max_length=20, null=True)),
                ('proof_documents', models.JSONField(default=list, help_text='List of uploaded proof URLs or file keys')),
                ('user_remarks', models.TextField(blank=True, null=True)),
                ('admin_reasons', models.TextField(blank=True, null=True)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected'), ('UNDER_REVIEW', 'Under Review')], default='PENDING', max_length=20)),
                ('is_void', models.BooleanField(default=False)),
                ('is_removed', models.BooleanField(default=False)),
                ('submitted_at', models.DateTimeField(auto_now_add=True)),
                ('reviewed_at', models.DateTimeField(blank=True, null=True)),
                ('linked_bank', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='deposit_requests', to='control_panel.depositbankaccount')),
                ('reviewed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='fund_requests_reviewed', to='control_panel.portaluser')),
                ('submitted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='fund_requests_made', to='control_panel.portaluser')),
            ],
            options={
                'verbose_name': 'Fund Deposit Request',
                'db_table': 'txn_fund_deposit_requests',
                'ordering': ['-submitted_at'],
                'indexes': [models.Index(fields=['utr_ref'], name='txn_fund_de_utr_ref_a0602f_idx'), models.Index(fields=['status'], name='txn_fund_de_status_4653ee_idx'), models.Index(fields=['submitted_at'], name='txn_fund_de_submitt_62f123_idx')],
            },
        ),
        migrations.CreateModel(
            name='PortalUserBalance',
            fields=[
                ('balance_id', models.BigAutoField(primary_key=True, serialize=False)),
                ('primary_balance', models.DecimalField(decimal_places=3, default=0.0, help_text='Main usable wallet', max_digits=20)),
                ('earnings_balance', models.DecimalField(decimal_places=3, default=0.0, help_text='Commission / Referral earnings', max_digits=20)),
                ('deposit_balance', models.DecimalField(blank=True, decimal_places=3, default=0.0, max_digits=20, null=True)),
                ('gateway_balance', models.DecimalField(blank=True, decimal_places=3, default=0.0, max_digits=20, null=True)),
                ('outstanding_balance', models.DecimalField(blank=True, decimal_places=3, default=0.0, max_digits=20, null=True)),
                ('hold_balance', models.DecimalField(blank=True, decimal_places=3, default=0.0, help_text='Lien / Frozen amount', max_digits=20, null=True)),
                ('created_on', models.DateTimeField(auto_now_add=True)),
                ('last_updated_on', models.DateTimeField(blank=True, null=True)),
                ('last_updated_by', models.PositiveIntegerField(blank=True, null=True)),
                ('user', models.OneToOneField(blank=True, db_column='portal_user_id', null=True, on_delete=django.db.models.deletion.PROTECT, related_name='wallet_account', to='control_panel.portaluser')),
            ],
            options={
                'verbose_name': 'User Wallet',
                'verbose_name_plural': 'User Wallets',
                'db_table': 'portal_user_balances',
                'indexes': [models.Index(fields=['user'], name='portal_user_portal__64715a_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='location',
            index=models.Index(fields=['title', 'region'], name='master_loca_title_3237fa_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='location',
            unique_together={('title', 'region')},
        ),
        migrations.AlterUniqueTogether(
            name='chargerule',
            unique_together={('service_provider', 'linked_identifier', 'charge_type', 'charge_beneficiary')},
        ),
        migrations.AlterUniqueTogether(
            name='adminservice',
            unique_together={('admin', 'service', 'provider')},
        ),
    ]
